# malware_detection.py - AI-Based File Hash Scanning
import joblib

# Load the pre-trained model
MODEL_PATH = "ai_models/malware_detection.pkl"
model = joblib.load(MODEL_PATH)

def scan_file_with_ai(file_hash):
    """
    Analyzes file hash using the AI model.
    Returns True if file is safe, False if unsafe.
    """
    # Convert hash into model-compatible format
    features = [ord(char) for char in file_hash]  # Example: simple conversion
    result = model.predict([features])
    return result[0] == "safe"
